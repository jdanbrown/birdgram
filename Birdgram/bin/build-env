#/bin/sh
# Can't rely on shebang line [why?]
set -eux
#
# From https://github.com/luggit/react-native-config/issues/187#issuecomment-353156419
# - cf. https://github.com/ueno-llc/react-native-starter/blob/master/scripts/build-env.sh

RNC_DIR='./node_modules/react-native-config/ios'

if [ -n "$SYMROOT" ]; then

  # Ensure dirs
  mkdir -p "$SYMROOT"
  mkdir -p "$BUILD_DIR"

  # Build dotenv
  (cd "$RNC_DIR" && ./ReactNativeConfig/BuildDotenvConfig.ruby)

  # Copy generated dotenv files to node_modules directory
  cp "$BUILD_DIR/GeneratedInfoPlistDotEnv.h" "$RNC_DIR/ReactNativeConfig/GeneratedInfoPlistDotEnv.h"
  cp "$SYMROOT/GeneratedDotEnv.m"            "$RNC_DIR/ReactNativeConfig/GeneratedDotEnv.m"

fi

# vi: ft=sh
